rm(list=ls())
library(tidyverse)
library(reshape2)
library(extrafont)
setwd("/Users/dcollins/Desktop/Manuscript/Figures/2_KHDSS_site_sequencing/")
my_data <- read.csv("KHDSS_site_sequencing_08112019.csv", sep = ",", header = T, stringsAsFactors = T)
View(my_data)
names(my_data)
pdf("H3N2_sequenced.pdf", width = 4, height = 3)
plot_data <- my_data%>%
melt(id.vars="site")%>%
rename(Month_collected=variable, No_cases=value)%>%
mutate(Month_collected=factor(Month_collected, levels=c("Dec_2015", "Jan_2016", "Feb_2016", "Mar_2016", "Apr_2016", "May_2016", "Jun_2016", "Jul_2016", "Aug_2016", "Sep_2016", "Oct_2016", "Nov_2016", "Dec_2016")))%>%
mutate(site=factor(site, levels=c("Junju", "Pingilikani","Chasimba", "Mavueni", "Jaribuni", "Mtondia", "Sokoke", "Ngerenya", "Matsangoni")))%>%
mutate(No_cases=replace(No_cases, No_cases==0, NA))
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 12),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
dev.off()
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 12),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 9),
axis.text.y = element_text(size = 12),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 12),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
setwd("/Users/dcollins/Desktop/Manuscript/Figures/1_KHDSS_site_frequency/")
my_data <- read.csv("KHDSS_site_frequency_08112019.csv", sep = ",", header = T, stringsAsFactors = T)
rm(list=ls())
library(tidyverse)
library(reshape2)
library(extrafont)
setwd("/Users/dcollins/Desktop/Manuscript/Figures/1_KHDSS_site_frequency/")
my_data <- read.csv("KHDSS_site_frequency_08112019.csv", sep = ",", header = T, stringsAsFactors = T)
names(my_data)
pdf("H3N2_all_samples.pdf", width = 4, height = 3)
plot_data <- my_data%>%
melt(id.vars="site")%>%
rename(Month_collected=variable, No_cases=value)%>%
mutate(Month_collected=factor(Month_collected, levels=c("Dec_2015", "Jan_2016", "Feb_2016", "Mar_2016", "Apr_2016", "May_2016", "Jun_2016", "Jul_2016", "Aug_2016", "Sep_2016", "Oct_2016", "Nov_2016", "Dec_2016")))%>%
mutate(site=factor(site, levels=c("Junju", "Pingilikani","Chasimba", "Mavueni", "Jaribuni", "Mtondia", "Sokoke", "Ngerenya", "Matsangoni")))%>%
mutate(No_cases=replace(No_cases, No_cases==0, NA))
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 15),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
dev.off()
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 15),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
rm(list=ls())
library(tidyverse)
library(reshape2)
library(extrafont)
setwd("/Users/dcollins/Desktop/Manuscript/Figures/1_KHDSS_site_frequency/")
my_data <- read.csv("KHDSS_site_frequency_08112019.csv", sep = ",", header = T, stringsAsFactors = T)
names(my_data)
pdf("H3N2_all_samples.pdf", width = 4, height = 3)
plot_data <- my_data%>%
melt(id.vars="site")%>%
rename(Month_collected=variable, No_cases=value)%>%
mutate(Month_collected=factor(Month_collected, levels=c("Dec_2015", "Jan_2016", "Feb_2016", "Mar_2016", "Apr_2016", "May_2016", "Jun_2016", "Jul_2016", "Aug_2016", "Sep_2016", "Oct_2016", "Nov_2016", "Dec_2016")))%>%
mutate(site=factor(site, levels=c("Junju", "Pingilikani","Chasimba", "Mavueni", "Jaribuni", "Mtondia", "Sokoke", "Ngerenya", "Matsangoni")))%>%
mutate(No_cases=replace(No_cases, No_cases==0, NA))
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 9),
axis.text.y = element_text(size = 15),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
dev.off()
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 9),
axis.text.y = element_text(size = 15),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 15),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 9),
axis.text.y = element_text(size = 15),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
rm(list=ls())
library(tidyverse)
library(reshape2)
library(extrafont)
setwd("~/Documents/PhD/Thesis/Chapter_3/1_KHDSS_site_frequency")
my_data <- read.csv("KHDSS_site_frequency_18022020.csv", sep = ",", header = T, stringsAsFactors = T)
names(my_data)
pdf("Site_frequency.pdf", width = 4, height = 3)
plot_data <- my_data%>%
melt(id.vars="site")%>%
rename(Month_collected=variable, No_cases=value)%>%
mutate(Month_collected=factor(Month_collected, levels=c("Dec_15", "Jan_16", "Feb_16", "Mar_16", "Apr_16", "May_16", "Jun_16", "Jul_16", "Aug_16", "Sep_16", "Oct_16", "Nov_16", "Dec_16")))%>%
mutate(site=factor(site, levels=c("Junju", "Pingilikani","Chasimba", "Mavueni", "Jaribuni", "Mtondia", "Sokoke", "Ngerenya", "Matsangoni")))%>%
mutate(No_cases=replace(No_cases, No_cases==0, NA))
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 17),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
dev.off()
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 17),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
rm(list=ls())
library(tidyverse)
library(reshape2)
library(extrafont)
setwd("~/Documents/PhD/Thesis/Thesis/Chapter_3/1_KHDSS_site_frequency")
my_data <- read.csv("KHDSS_site_frequency_18022020.csv", sep = ",", header = T, stringsAsFactors = T)
names(my_data)
pdf("Site_frequency.pdf", width = 4, height = 3)
plot_data <- my_data%>%
melt(id.vars="site")%>%
rename(Month_collected=variable, No_cases=value)%>%
mutate(Month_collected=factor(Month_collected, levels=c("Dec_15", "Jan_16", "Feb_16", "Mar_16", "Apr_16", "May_16", "Jun_16", "Jul_16", "Aug_16", "Sep_16", "Oct_16", "Nov_16", "Dec_16")))%>%
mutate(site=factor(site, levels=c("Junju", "Pingilikani","Chasimba", "Mavueni", "Jaribuni", "Mtondia", "Sokoke", "Ngerenya", "Matsangoni")))%>%
mutate(No_cases=replace(No_cases, No_cases==0, NA))
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 22),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 17),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
dev.off()
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 22),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 17),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
ggplot(plot_data, aes(x=Month_collected, y=site, size=(No_cases)*0.6))+
geom_point()+
#scale_color_manual(values=c("#FF0000", "#00FF00", "#0000FF", "#00FFFF","#FF00FF","#808080", "#800000","#808000", "#800080"))+
labs(x="Month", y="Health facility")+
scale_size_identity()+
theme_classic()+
theme(axis.title.x = element_text(size = 22),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 19),
#legend.position = "none",
legend.key.size = unit(0.45, "cm"),
legend.spacing.x = unit(0.5, 'cm'),
legend.text = element_text(size = 11),
legend.title =element_blank(),
legend.box.background = element_blank())+
guides(color = FALSE)
